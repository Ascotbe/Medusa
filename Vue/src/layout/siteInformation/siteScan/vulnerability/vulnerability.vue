<template>
<div class="vulnerability">
    <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-nav-screen">
        <a-col :xs="{ span: 24}" :lg="{ span: 10}" class="vulnerabilityDetails-nav-screen-option">
            风险等级：
            <a-checkbox-group @change="handleOnChange">
                <a-checkbox value="heightrisk">高危</a-checkbox>
                <a-checkbox value="mediumrisk">中危</a-checkbox>
                <a-checkbox value="lowrisk">低危</a-checkbox>
            </a-checkbox-group>
        </a-col>
    </a-col>

    <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-nav-tabsAndTips">
        <a-col :xs="{ span: 24}" :lg="{ span: 8}" class="vulnerabilityDetails-nav-screen-tips">
            <a-col :xs="{ span: 8}" :lg="{ span: 8}" style="color: rgba(223,61,60,1)">高危:0</a-col>
            <a-col :xs="{ span: 8}" :lg="{ span: 8}" style="color: rgba(254,140,19,1)">中危:0</a-col>
            <a-col :xs="{ span: 8}" :lg="{ span: 8}" style="color: rgba(54,136,255,1)">低危:0</a-col>
        </a-col>
        <a-row :gutter="[{ xs: 8, sm: 16, md: 24, xs: 8 },{xs: 0, sm: 0, md: 0, lg: 0 }]">
            <a-col :xs="{ span: 24}" :lg="{ span: 8,push:7}" :xl="{ span: 8,push:8}" :xxl="{ span: 6,push:10}" class="vulnerabilityDetails-nav-screen-tabs">
                <a-col :xs="{ span: 6}" :md="{ span: 6}" :lg="{ span: 6}" :xl="{ span: 6}" :xxl="{ span: 6}" v-for="(index,i) in  vulnerabilityDetailsTabs" :key="i" @click="fnScreenTabs(index,i)" class="vulnerabilityDetailsTab" :class="{vulnerabilityDetailsActive:vulnerabilityDetailsActive==i}">{{index.name}}</a-col>
            </a-col>
            <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-nav-list">
                <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-nav-list-data">
                    <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-nav-list-data-name">
                        <a-col :xs="{ span: 8}" :lg="{ span: 8}">URL</a-col>
                        <a-col :xs="{ span: 8}" :lg="{ span: 8}">状态</a-col>
                        <a-col :xs="{ span: 8}" :lg="{ span: 8}">操作</a-col>
                    </a-col>
                    <a-col :xs="{ span: 24}" :lg="{ span: 24}" class="vulnerabilityDetails-nav-list-data-val">
                        <div class="vulnerabilityDetails-nav-list-data-val-for" v-for="(item,i) in vulnerabilityDetailsDataTabs" :key="i">
                            <a-col :xs="{ span: 8}" :lg="{ span: 8}" class="vulnerabilityDetails-nav-list-data-val-for-hover">{{item.url}}</a-col>
                            <a-col :xs="{ span: 8}" :lg="{ span: 8}" class="vulnerabilityDetails-nav-list-data-val-for-hover">{{item.type}}</a-col>
                            <a-col :xs="{ span: 8}" :lg="{ span: 8}" class="vulnerabilityDetails-nav-list-data-val-for-hover">
                                查询
                                <a-popover trigger="click">
                                    <template slot="content">
                                        <p @click="handleGoycjnb(item.url)">XXXXX</p>
                                        <p>XXXXX</p>
                                    </template>
                                    处理
                                    <a-icon type="caret-down" />
                                </a-popover>
                            </a-col>
                        </div>
                    </a-col>
                </a-col>
                <a-col :xs="{ span: 20,push:2}" :sm="{ span: 16,push:4}" :lg="{ span: 12,push:6}" :xl="{ span: 10,push:7}" :xxl="{ span: 8,push:8}">
                    <a-pagination class="vulnerabilityDetails-nav-list-pagination" size="small" :total="total" :pageSize.sync="pageSize" :show-total="total => `共 ${total} 条数据`" show-quick-jumper v-model="current" @change="fnonChange" :item-render="itemRender" />
                </a-col>
            </a-col>
        </a-row>
    </a-col>
</div>
</template>

<script>
export default {
    name: "vulnerability",
    data() {
        return {
            vulnerabilityDetailsActive: 0,
            vulnerabilityDetailsTabs: [{
                    name: "全部",
                },
                {
                    name: "待修复",
                },
                {
                    name: "已修复",
                },
                {
                    name: "已忽略",
                },
            ],
            vulnerabilityDetailsData: [{
                //总数据
                url: "www.baidu.com",
                type: "已修复",
            }],
            vulnerabilityDetailsDataTabs: [{
                url: "www.baidu.com",
                type: "已修复",
            }], //有tabs查询条件的数据
            total: 4, //数句总数
            vulnerabilityDetailsDataList: [], //但前页数据
            current: 1, //默认当前页
            pageSize: 5, //一页显示数量
        };
    },
    mounted() {
        this.fnVulnerabilityPaging();
    },
    methods: {
        fnScreenTabs(index, i) {
            //tabs切换并查询
            this.vulnerabilityDetailsActive = i;
            this.vulnerabilityDetailsDataTabs = [];
            if (index.name == "全部") {
                this.vulnerabilityDetailsDataTabs = this.vulnerabilityDetailsData;
            } else {
                for (let i = 0; i < this.vulnerabilityDetailsData.length; i++) {
                    if (index.name == this.vulnerabilityDetailsData[i].type) {
                        this.vulnerabilityDetailsDataTabs.push(
                            this.vulnerabilityDetailsData[i]
                        );
                    }
                }
            }
            console.log(index);
            this.fnVulnerabilityPaging();
        },
        handleOnChange(checkedValues) {
            console.log("checked = ", checkedValues);
        },
        fnVulnerabilityPaging() {
            this.total = this.vulnerabilityDetailsDataTabs.length;
            for (let i = 0; i < this.pageSize; i++) {
                this.vulnerabilityDetailsDataList.push(
                    this.vulnerabilityDetailsDataTabs[i]
                );
            }
        },
        fnonChange(pageNumber, pageSize) {
            console.log("Page: ", pageNumber, pageSize);
            let start = pageNumber * this.pageSize - this.pageSize;
            let end = 0;
            pageNumber * this.pageSize - 1 <=
                this.vulnerabilityDetailsDataTabs.length - 1 ?
                (end = pageNumber * this.pageSize - 1) :
                (end = this.vulnerabilityDetailsDataTabs.length - 1);
            this.vulnerabilityDetailsDataList = [];
            for (let i = start; i <= end; i++) {
                this.vulnerabilityDetailsDataList.push(
                    this.vulnerabilityDetailsDataTabs[i]
                );
            }
        },
        itemRender(current, type, originalElement) {
            if (type === "prev") {
                return "上一页";
            } else if (type === "next") {
                return "下一页";
            }
            return originalElement;
        },
        handleGoycjnb(url) {
            console.log(url)
            this.$router.push("/layout/siteScan/vulnerabilityDetails");
        }
    },
};
</script>

<style lang="scss">
.vulnerability {
    .vulnerabilityDetails-nav-screen {
        margin-top: 20px;
        background: #587797;
    }

    .vulnerabilityDetails-nav-tabsAndTips {
        .vulnerabilityDetails-nav-screen-tabs {
            min-height: 20px;
            min-width: 265px;
            padding-top: 10px;

            .vulnerabilityDetailsTab {
                min-width: 60px;
                padding: 10px;
                color: #fff;
                border-top-left-radius: 5px;
                border-top-right-radius: 5px;
                text-align: center;
                //margin-right: 20px;
                font: 0.1rem sans-serif;
            }

            .vulnerabilityDetailsTab.vulnerabilityDetailsActive {
                background: #587797;
            }
        }
    }

    .vulnerabilityDetails-nav-list {
        padding: 10px;
        background: #587797;

        .vulnerabilityDetails-nav-list-data {
            background: #2e4051;

            .vulnerabilityDetails-nav-list-data-name {
                padding-top: 5px;
                text-align: center;
            }

            .vulnerabilityDetails-nav-list-data-val {
                text-align: center;

                height: 100px;

                .vulnerabilityDetails-nav-list-data-val-for {
                    padding-top: 10px;
                    height: 100px;
                    padding-bottom: 10px;
                }
            }
        }
    }
}

.vulnerabilityDetails-nav-list-pagination {
    color: floralwhite !important;

    .ant-pagination-prev,
    .ant-pagination-next,
    .ant-pagination-item a {
        font-size: 0.07rem;
        color: floralwhite !important;
    }

    .ant-pagination-item-active a {
        font-size: 0.07rem;
        color: #1890ff !important;
    }
}
</style>
